<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://jekyllrb.com/" version="3.8.4">Jekyll</generator><link href="https://blog.toshima.ru/feed.xml" rel="self" type="application/atom+xml" /><link href="https://blog.toshima.ru/" rel="alternate" type="text/html" /><updated>2018-10-22T12:01:56+09:00</updated><id>https://blog.toshima.ru/feed.xml</id><title type="html">Toshimaru’s Blog</title><subtitle>Where there's a will, there's a way.
</subtitle><author><name>toshimaru</name></author><entry><title type="html">Run and Connect to MySQL on Docker</title><link href="https://blog.toshima.ru/2018/09/16/docker-run-mysql.html" rel="alternate" type="text/html" title="Run and Connect to MySQL on Docker" /><published>2018-09-16T00:00:00+09:00</published><updated>2018-09-16T00:00:00+09:00</updated><id>https://blog.toshima.ru/2018/09/16/docker-run-mysql</id><content type="html" xml:base="https://blog.toshima.ru/2018/09/16/docker-run-mysql.html">&lt;p&gt;I wanted to run MySQL 8.0.x on docker aside from MySQL 5.7 running on my localhost, so I’ll give a instruction for it.&lt;/p&gt;

&lt;h2 id=&quot;docker-pull&quot;&gt;docker pull&lt;/h2&gt;

&lt;p&gt;First of all, let’s run &lt;code class=&quot;highlighter-rouge&quot;&gt;docker pull&lt;/code&gt;.&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ docker pull mysql:8.0
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;(&lt;code class=&quot;highlighter-rouge&quot;&gt;8.0&lt;/code&gt; means a tag. if it’s not specified, latest mysql docker image is used.)&lt;/p&gt;

&lt;h2 id=&quot;docker-run&quot;&gt;docker run&lt;/h2&gt;

&lt;p&gt;Then, run &lt;code class=&quot;highlighter-rouge&quot;&gt;docker run&lt;/code&gt;.&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ docker run --name mysql -e MYSQL_ROOT_PASSWORD=xxxx -p 3306:3306 mysql:8.0
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;MYSQL_ROOT_PASSWORD&lt;/code&gt; is required, you can set whatever password you like.&lt;/p&gt;

&lt;h2 id=&quot;connect-to-mysql&quot;&gt;Connect to MySQL&lt;/h2&gt;

&lt;p&gt;Finally, let’s conect to MySQL run by docker.&lt;/p&gt;

&lt;div class=&quot;language-console highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;gp&quot;&gt;$&lt;/span&gt; mysql &lt;span class=&quot;nt&quot;&gt;-h&lt;/span&gt; 127.0.0.1 &lt;span class=&quot;nt&quot;&gt;-u&lt;/span&gt; root &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt;
&lt;span class=&quot;go&quot;&gt;Enter password:
ERROR 2059 (HY000): Authentication plugin 'caching_sha2_password' cannot be loaded: dlopen(/usr/local/Cellar/mysql/5.7.22/lib/plugin/caching_sha2_password.so, 2): image not found
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;But we’ve got an error. This is because mysql server version and client version are different and those encryption methods are different.&lt;/p&gt;

&lt;p&gt;Let’s connect to mysql on docker.&lt;/p&gt;

&lt;div class=&quot;language-console highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;gp&quot;&gt;#&lt;/span&gt; from localhost
&lt;span class=&quot;gp&quot;&gt;$&lt;/span&gt; docker &lt;span class=&quot;nb&quot;&gt;exec&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-it&lt;/span&gt; mysql bash 
&lt;span class=&quot;go&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;gp&quot;&gt;#&lt;/span&gt; inside docker
&lt;span class=&quot;gp&quot;&gt;#&lt;/span&gt; mysql &lt;span class=&quot;nt&quot;&gt;-uroot&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; 
&lt;span class=&quot;go&quot;&gt;Enter password:

&lt;/span&gt;&lt;span class=&quot;gp&quot;&gt;Type 'help;&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;' or '&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\h&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;' for help. Type '&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\c&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;' to clear the current input statement.
&lt;/span&gt;&lt;span class=&quot;go&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;gp&quot;&gt;mysql&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;It works!&lt;/p&gt;

&lt;h2 id=&quot;reference&quot;&gt;Reference&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://stackoverflow.com/questions/49194719/authentication-plugin-caching-sha2-password-cannot-be-loaded&quot;&gt;mysql - Authentication plugin ‘caching_sha2_password’ cannot be loaded - Stack Overflow&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content><author><name>toshimaru</name></author><category term="mysql" /><category term="docker" /><summary type="html">I wanted to run MySQL 8.0.x on docker aside from MySQL 5.7 running on my localhost, so I’ll give a instruction for it.</summary></entry><entry><title type="html">How to Find MySQL my.cnf file</title><link href="https://blog.toshima.ru/2018/08/19/how-to-find-mycnf.html" rel="alternate" type="text/html" title="How to Find MySQL my.cnf file" /><published>2018-08-19T00:00:00+09:00</published><updated>2018-08-19T00:00:00+09:00</updated><id>https://blog.toshima.ru/2018/08/19/how-to-find-mycnf</id><content type="html" xml:base="https://blog.toshima.ru/2018/08/19/how-to-find-mycnf.html">&lt;h2 id=&quot;mysql-version&quot;&gt;MySQL Version&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;MySQL 5.7&lt;/li&gt;
&lt;/ul&gt;

&lt;div class=&quot;language-console highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;gp&quot;&gt;$&lt;/span&gt; mysql &lt;span class=&quot;nt&quot;&gt;--version&lt;/span&gt;
&lt;span class=&quot;go&quot;&gt;mysql  Ver 14.14 Distrib 5.7.22, for osx10.13 (x86_64) using  EditLine wrapper
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;how-to-find-mycnf&quot;&gt;How to find my.cnf&lt;/h2&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;mysql --help&lt;/code&gt; outputs your possible &lt;code class=&quot;highlighter-rouge&quot;&gt;my.cnf&lt;/code&gt; path. So, what you need to do is &lt;code class=&quot;highlighter-rouge&quot;&gt;grep my.cnf&lt;/code&gt;.&lt;/p&gt;

&lt;div class=&quot;language-console highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;gp&quot;&gt;$&lt;/span&gt; mysql &lt;span class=&quot;nt&quot;&gt;--help&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;grep &lt;/span&gt;my.cnf
&lt;span class=&quot;gp&quot;&gt; order of preference, my.cnf, $&lt;/span&gt;MYSQL_TCP_PORT,
&lt;span class=&quot;go&quot;&gt;/etc/my.cnf /etc/mysql/my.cnf /usr/local/etc/my.cnf ~/.my.cnf
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;One of which is your MySQL configuration file(in this case, &lt;code class=&quot;highlighter-rouge&quot;&gt;/usr/local/etc/my.cnf&lt;/code&gt;).&lt;/p&gt;

&lt;div class=&quot;language-console highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;gp&quot;&gt;$&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;cat&lt;/span&gt; /usr/local/etc/my.cnf
&lt;span class=&quot;gp&quot;&gt;#&lt;/span&gt; Default Homebrew MySQL server config
&lt;span class=&quot;go&quot;&gt;[mysqld]
&lt;/span&gt;&lt;span class=&quot;gp&quot;&gt;#&lt;/span&gt; Only allow connections from localhost
&lt;span class=&quot;go&quot;&gt;bind-address = 127.0.0.1
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;</content><author><name>toshimaru</name></author><category term="mysql" /><summary type="html">MySQL Version</summary></entry><entry><title type="html">Select unique values from a column in ActiveRecord</title><link href="https://blog.toshima.ru/2018/08/04/activerecord-distinct-pluck.html" rel="alternate" type="text/html" title="Select unique values from a column in ActiveRecord" /><published>2018-08-04T00:00:00+09:00</published><updated>2018-08-04T00:00:00+09:00</updated><id>https://blog.toshima.ru/2018/08/04/activerecord-distinct-pluck</id><content type="html" xml:base="https://blog.toshima.ru/2018/08/04/activerecord-distinct-pluck.html">&lt;p&gt;IF you want to select unique values from a column in ActiveRecord, you can use &lt;code class=&quot;highlighter-rouge&quot;&gt;distinct&lt;/code&gt; + &lt;code class=&quot;highlighter-rouge&quot;&gt;pluck&lt;/code&gt;.&lt;/p&gt;

&lt;div class=&quot;language-rb highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;no&quot;&gt;Model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;distinct&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;pluck&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt;:column&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;For example:&lt;/p&gt;

&lt;div class=&quot;language-rb highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;no&quot;&gt;User&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;distinct&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;pluck&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt;:id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;#    (0.1ms)  SELECT DISTINCT &quot;users&quot;.&quot;id&quot; FROM &quot;users&quot;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;You can also get unique values from multiple columns.&lt;/p&gt;

&lt;div class=&quot;language-rb highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;no&quot;&gt;User&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;distinct&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;pluck&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt;:id&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;:name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;#    (0.1ms)  SELECT DISTINCT &quot;users&quot;.&quot;id&quot;, &quot;users&quot;.&quot;name&quot; FROM &quot;users&quot;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;see-also&quot;&gt;See also&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://stackoverflow.com/questions/9658881/rails-select-unique-values-from-a-column&quot;&gt;activerecord - Rails: select unique values from a column - Stack Overflow&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content><author><name>toshimaru</name></author><category term="activerecord" /><category term="rails" /><summary type="html">IF you want to select unique values from a column in ActiveRecord, you can use distinct + pluck.</summary></entry><entry><title type="html">VSCode Setting for Rubyist</title><link href="https://blog.toshima.ru/2018/07/12/vscode-for-ruby.html" rel="alternate" type="text/html" title="VSCode Setting for Rubyist" /><published>2018-07-12T00:00:00+09:00</published><updated>2018-07-12T00:00:00+09:00</updated><id>https://blog.toshima.ru/2018/07/12/vscode-for-ruby</id><content type="html" xml:base="https://blog.toshima.ru/2018/07/12/vscode-for-ruby.html">&lt;h2 id=&quot;intellisense&quot;&gt;Intellisense&lt;/h2&gt;

&lt;p&gt;To use VSCode &lt;code class=&quot;highlighter-rouge&quot;&gt;go to&lt;/code&gt;/&lt;code class=&quot;highlighter-rouge&quot;&gt;peek definition&lt;/code&gt;/&lt;code class=&quot;highlighter-rouge&quot;&gt;symbol&lt;/code&gt;, you have to set &lt;code class=&quot;highlighter-rouge&quot;&gt;ruby.intellisense&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;Valid options are &lt;code class=&quot;highlighter-rouge&quot;&gt;rubyLocate&lt;/code&gt; and &lt;code class=&quot;highlighter-rouge&quot;&gt;false&lt;/code&gt;. Default option is &lt;code class=&quot;highlighter-rouge&quot;&gt;false&lt;/code&gt;, so set &lt;code class=&quot;highlighter-rouge&quot;&gt;rubyLocate&lt;/code&gt;.&lt;/p&gt;

&lt;div class=&quot;language-json highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;ruby.intellisense&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;rubyLocate&quot;&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Now, you can use &lt;code class=&quot;highlighter-rouge&quot;&gt;Go to Symbols&lt;/code&gt; and &lt;code class=&quot;highlighter-rouge&quot;&gt;Go to Definition&lt;/code&gt;.&lt;/p&gt;

&lt;h2 id=&quot;lint&quot;&gt;Lint&lt;/h2&gt;

&lt;p&gt;You can also use &lt;code class=&quot;highlighter-rouge&quot;&gt;ruby -wc&lt;/code&gt; syntax check as a lint(By default no linters are turned on).&lt;/p&gt;

&lt;div class=&quot;language-json highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;ruby.lint&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;ruby&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;If you are unicode user, set &lt;code class=&quot;highlighter-rouge&quot;&gt;unicode&lt;/code&gt;.&lt;/p&gt;

&lt;div class=&quot;language-json highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;ruby.lint&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
        &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;ruby&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;unicode&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
    &lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;reference&quot;&gt;Reference&lt;/h2&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/rubyide/vscode-ruby&quot;&gt;rubyide/vscode-ruby&lt;/a&gt;&lt;/p&gt;</content><author><name>toshimaru</name></author><category term="vscode" /><category term="ruby" /><summary type="html">Intellisense</summary></entry><entry><title type="html">MySQL Load CSV Data into Table</title><link href="https://blog.toshima.ru/2018/02/17/mysql-load-data-infile.html" rel="alternate" type="text/html" title="MySQL Load CSV Data into Table" /><published>2018-02-17T00:00:00+09:00</published><updated>2018-02-17T00:00:00+09:00</updated><id>https://blog.toshima.ru/2018/02/17/mysql-load-data-infile</id><content type="html" xml:base="https://blog.toshima.ru/2018/02/17/mysql-load-data-infile.html">&lt;h2 id=&quot;environment&quot;&gt;Environment&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;MySQL 5.7&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;load-data-infile&quot;&gt;LOAD DATA INFILE&lt;/h2&gt;

&lt;p&gt;If you want to import CSV data into MySQL table, it’d be good to use MySQL &lt;code class=&quot;highlighter-rouge&quot;&gt;LOAD DATA INFILE&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;ref. &lt;a href=&quot;https://dev.mysql.com/doc/refman/5.7/en/load-data.html&quot;&gt;MySQL :: MySQL 5.7 Reference Manual :: 13.2.6 LOAD DATA INFILE Syntax&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Let’s use it on the command line.&lt;/p&gt;

&lt;div class=&quot;language-console highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;gp&quot;&gt;$&lt;/span&gt; mysql &lt;span class=&quot;nt&quot;&gt;-u&lt;/span&gt; root &lt;span class=&quot;nt&quot;&gt;-e&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;LOAD DATA INFILE './data.csv' INTO TABLE db_development.users(email, password);&quot;&lt;/span&gt;
&lt;span class=&quot;go&quot;&gt;ERROR 1290 (HY000) at line 1: The MySQL server is running with the --secure-file-priv option so it cannot execute this statement
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;But I’ve got an error, which says &lt;em&gt;The MySQL server is running with the –secure-file-priv option&lt;/em&gt;.&lt;/p&gt;

&lt;h2 id=&quot;load-data-local-infile&quot;&gt;LOAD DATA LOCAL INFILE&lt;/h2&gt;

&lt;p&gt;&lt;a href=&quot;https://stackoverflow.com/a/40630313&quot;&gt;A stackoverflow answer&lt;/a&gt; says it’s good to use &lt;code class=&quot;highlighter-rouge&quot;&gt;LOAD DATA LOCAL&lt;/code&gt;.&lt;/p&gt;

&lt;div class=&quot;language-console highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;gp&quot;&gt;$&lt;/span&gt; mysql &lt;span class=&quot;nt&quot;&gt;-u&lt;/span&gt; root &lt;span class=&quot;nt&quot;&gt;-e&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;LOAD DATA LOCAL INFILE './data.csv' INTO TABLE db_development.users(email, password);&quot;&lt;/span&gt;
&lt;span class=&quot;go&quot;&gt;ERROR 1148 (42000) at line 1: The used command is not allowed with this MySQL version
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Hmm, we’ve got another error, which says &lt;em&gt;The used command is not allowed with this MySQL version&lt;/em&gt;.&lt;/p&gt;

&lt;h2 id=&quot;local-infile-option&quot;&gt;local-infile option&lt;/h2&gt;

&lt;p&gt;&lt;a href=&quot;https://stackoverflow.com/a/10762399&quot;&gt;Another answer&lt;/a&gt; says it should be used with &lt;code class=&quot;highlighter-rouge&quot;&gt;--local-infile&lt;/code&gt; option.&lt;/p&gt;

&lt;div class=&quot;language-console highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;gp&quot;&gt;$&lt;/span&gt; mysql &lt;span class=&quot;nt&quot;&gt;-u&lt;/span&gt; root &lt;span class=&quot;nt&quot;&gt;--local-infile&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-e&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;LOAD DATA LOCAL INFILE './data.csv' INTO TABLE db_development.users(email, password);&quot;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;It worked, but imported data was a bit wrong because I didn’t specify fields separator. The CSV data was separated by comma(&lt;code class=&quot;highlighter-rouge&quot;&gt;,&lt;/code&gt;), so let’s specify comma.&lt;/p&gt;

&lt;div class=&quot;language-console highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;gp&quot;&gt;$&lt;/span&gt; mysql &lt;span class=&quot;nt&quot;&gt;-u&lt;/span&gt; root &lt;span class=&quot;nt&quot;&gt;--local-infile&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-e&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;LOAD DATA LOCAL INFILE './data.csv' INTO TABLE db_development.users FIELDS TERMINATED BY ',' (email, password);&quot;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;It properly worked!&lt;/p&gt;

&lt;h2 id=&quot;other-reference&quot;&gt;Other Reference&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://dev.mysql.com/doc/refman/5.7/en/command-line-options.html&quot;&gt;MySQL :: MySQL 5.7 Reference Manual :: 4.2.4 Using Options on the Command Line&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content><author><name>toshimaru</name></author><category term="mysql" /><summary type="html">Environment</summary></entry><entry><title type="html">Run Rails Database Console</title><link href="https://blog.toshima.ru/2018/01/05/rails-dbconsole.html" rel="alternate" type="text/html" title="Run Rails Database Console" /><published>2018-01-05T00:00:00+09:00</published><updated>2018-01-05T00:00:00+09:00</updated><id>https://blog.toshima.ru/2018/01/05/rails-dbconsole</id><content type="html" xml:base="https://blog.toshima.ru/2018/01/05/rails-dbconsole.html">&lt;h2 id=&quot;rails-dbconsole&quot;&gt;rails dbconsole&lt;/h2&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;rails dbconsole&lt;/code&gt; opens database console for you based on your application &lt;code class=&quot;highlighter-rouge&quot;&gt;database.yml&lt;/code&gt;.&lt;/p&gt;

&lt;div class=&quot;language-console highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;gp&quot;&gt;$&lt;/span&gt; rails dbconsole
&lt;span class=&quot;go&quot;&gt;Reading table information for completion of table and column names
You can turn off this feature to get a quicker startup with -A

&lt;/span&gt;&lt;span class=&quot;gp&quot;&gt;Welcome to the MySQL monitor.  Commands end with ;&lt;/span&gt; or &lt;span class=&quot;se&quot;&gt;\g&lt;/span&gt;&lt;span class=&quot;nb&quot;&gt;.&lt;/span&gt;
&lt;span class=&quot;go&quot;&gt;Your MySQL connection id is 6
Server version: 5.6.x MySQL Community Server (GPL)

Copyright (c) 2000, 2017, Oracle and/or its affiliates. All rights reserved.

Oracle is a registered trademark of Oracle Corporation and/or its
affiliates. Other names may be trademarks of their respective
owners.

&lt;/span&gt;&lt;span class=&quot;gp&quot;&gt;Type 'help;&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;' or '&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\h&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;' for help. Type '&lt;/span&gt;&lt;span class=&quot;se&quot;&gt;\c&lt;/span&gt;&lt;span class=&quot;s1&quot;&gt;' to clear the current input statement.
&lt;/span&gt;&lt;span class=&quot;go&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;gp&quot;&gt;mysql&amp;gt;&lt;/span&gt; show databases&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;span class=&quot;go&quot;&gt;+--------------------+
| Database           |
+--------------------+
| information_schema |
| mysql              |
| performance_schema |
+--------------------+
3 rows in set (0.00 sec)
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This is useful to validate your &lt;code class=&quot;highlighter-rouge&quot;&gt;database.yml&lt;/code&gt; configuration.&lt;/p&gt;

&lt;h2 id=&quot;rails-db&quot;&gt;rails db&lt;/h2&gt;

&lt;p&gt;You can also use &lt;code class=&quot;highlighter-rouge&quot;&gt;rails db&lt;/code&gt; command.&lt;/p&gt;

&lt;div class=&quot;language-console highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;gp&quot;&gt;$&lt;/span&gt; rails db
&lt;span class=&quot;go&quot;&gt;SQLite version 3.19.3 2017-06-27 16:48:08
Enter &quot;.help&quot; for usage hints.
&lt;/span&gt;&lt;span class=&quot;gp&quot;&gt;sqlite&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;reference&quot;&gt;Reference&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;http://guides.rubyonrails.org/command_line.html#rails-dbconsole&quot;&gt;The Rails Command Line — Ruby on Rails Guides&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content><author><name>toshimaru</name></author><category term="rails" /><summary type="html">rails dbconsole</summary></entry><entry><title type="html">Visual Studio Code: How to Insert New Line at the End of File</title><link href="https://blog.toshima.ru/2017/11/16/vscode-insert-new-line-at-end.html" rel="alternate" type="text/html" title="Visual Studio Code: How to Insert New Line at the End of File" /><published>2017-11-16T00:00:00+09:00</published><updated>2017-11-16T00:00:00+09:00</updated><id>https://blog.toshima.ru/2017/11/16/vscode-insert-new-line-at-end</id><content type="html" xml:base="https://blog.toshima.ru/2017/11/16/vscode-insert-new-line-at-end.html">&lt;p&gt;Aftre openning “Settings”, add a line to configuration JSON as follows:&lt;/p&gt;

&lt;div class=&quot;language-json highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
  &lt;/span&gt;&lt;span class=&quot;err&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
  &lt;/span&gt;&lt;span class=&quot;s2&quot;&gt;&quot;files.insertFinalNewline&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;w&quot;&gt; &lt;/span&gt;&lt;span class=&quot;kc&quot;&gt;true&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;w&quot;&gt;
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;refefence&quot;&gt;Refefence&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://stackoverflow.com/questions/44704968/visual-studio-code-insert-new-line-at-the-end-of-files&quot;&gt;Visual Studio Code — Insert New Line at the End of Files - Stack Overflow&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content><author><name>toshimaru</name></author><category term="vscode" /><summary type="html">Aftre openning “Settings”, add a line to configuration JSON as follows:</summary></entry><entry><title type="html">MySQL: Insert Result of Select query</title><link href="https://blog.toshima.ru/2017/10/16/mysql-insert-result-of-select.html" rel="alternate" type="text/html" title="MySQL: Insert Result of Select query" /><published>2017-10-16T00:00:00+09:00</published><updated>2017-10-16T00:00:00+09:00</updated><id>https://blog.toshima.ru/2017/10/16/mysql-insert-result-of-select</id><content type="html" xml:base="https://blog.toshima.ru/2017/10/16/mysql-insert-result-of-select.html">&lt;p&gt;You don’t need to use &lt;code class=&quot;highlighter-rouge&quot;&gt;VALUES&lt;/code&gt; after &lt;code class=&quot;highlighter-rouge&quot;&gt;INSERT INTO&lt;/code&gt;. Just use &lt;code class=&quot;highlighter-rouge&quot;&gt;SELECT&lt;/code&gt; after &lt;code class=&quot;highlighter-rouge&quot;&gt;INSERT INTO&lt;/code&gt;.&lt;/p&gt;

&lt;div class=&quot;language-sql highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;INSERT&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;INTO&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;table_name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;col1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;col2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;...)&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;SELECT&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;col1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;col2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;FROM&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;another_table_name&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;reference&quot;&gt;Reference&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://dev.mysql.com/doc/refman/5.7/en/insert-select.html&quot;&gt;MySQL :: MySQL 5.7 Reference Manual :: 13.2.5.1 INSERT … SELECT Syntax&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content><author><name>toshimaru</name></author><category term="mysql" /><summary type="html">You don’t need to use VALUES after INSERT INTO. Just use SELECT after INSERT INTO.</summary></entry><entry><title type="html">Check SSL Certificate Expiration Date via Command Line</title><link href="https://blog.toshima.ru/2017/09/22/ssl-expiration-check-via-command-line.html" rel="alternate" type="text/html" title="Check SSL Certificate Expiration Date via Command Line" /><published>2017-09-22T00:00:00+09:00</published><updated>2017-09-22T00:00:00+09:00</updated><id>https://blog.toshima.ru/2017/09/22/ssl-expiration-check-via-command-line</id><content type="html" xml:base="https://blog.toshima.ru/2017/09/22/ssl-expiration-check-via-command-line.html">&lt;p&gt;If you wanna check SSL certificate expiration date for specific domain via command line, you can use &lt;code class=&quot;highlighter-rouge&quot;&gt;openssl&lt;/code&gt; command.&lt;/p&gt;

&lt;p&gt;Let’s check &lt;code class=&quot;highlighter-rouge&quot;&gt;google.com:443&lt;/code&gt; certificate expiration date using &lt;code class=&quot;highlighter-rouge&quot;&gt;openssl&lt;/code&gt;.&lt;/p&gt;

&lt;div class=&quot;language-console highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;gp&quot;&gt;$&lt;/span&gt; openssl s_client &lt;span class=&quot;nt&quot;&gt;-connect&lt;/span&gt; google.com:443 &lt;span class=&quot;nt&quot;&gt;-servername&lt;/span&gt; google.com &amp;lt; /dev/null 2&amp;gt; /dev/null | openssl x509 &lt;span class=&quot;nt&quot;&gt;-text&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;grep&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;After&quot;&lt;/span&gt;
&lt;span class=&quot;go&quot;&gt;            Not After : Dec  6 17:09:00 2017 GMT
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;Dec  6 17:09:00 2017 GMT&lt;/code&gt; is expiration date.&lt;/p&gt;

&lt;h2 id=&quot;reference&quot;&gt;Reference&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.shellhacks.com/openssl-check-ssl-certificate-expiration-date/&quot;&gt;OpenSSL: Check SSL Certificate Expiration Date and More - ShellHacks&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;[Japanese] &lt;a href=&quot;https://blog.manabusakai.com/2016/07/lambda-cert-expire/&quot;&gt;Lambda を使って SSL サーバ証明書の有効期限をチェックする&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content><author><name>toshimaru</name></author><category term="ssl" /><category term="bash" /><summary type="html">If you wanna check SSL certificate expiration date for specific domain via command line, you can use openssl command.</summary></entry><entry><title type="html">CircleCI 2 speeds up your CI build time drastically</title><link href="https://blog.toshima.ru/2017/08/18/circleci2-speeds-up-your-ci-time.html" rel="alternate" type="text/html" title="CircleCI 2 speeds up your CI build time drastically" /><published>2017-08-18T00:00:00+09:00</published><updated>2017-08-18T00:00:00+09:00</updated><id>https://blog.toshima.ru/2017/08/18/circleci2-speeds-up-your-ci-time</id><content type="html" xml:base="https://blog.toshima.ru/2017/08/18/circleci2-speeds-up-your-ci-time.html">&lt;p&gt;&lt;a href=&quot;https://circleci.com/blog/launching-today-circleci-2-0-reaches-general-availability/&quot;&gt;CircleCI 2 has been released&lt;/a&gt;, which makes your CI faster and flexible.&lt;/p&gt;

&lt;p&gt;I’ve accomplished 3 times faster CI build time on &lt;a href=&quot;https://github.com/toshimaru/RailsTwitterClone&quot;&gt;my public project&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;&lt;amp-img src=&quot;/images/circleci2.png&quot; alt=&quot;faster build time&quot; width='1702' height='996' layout='responsive'&gt;&lt;/amp-img&gt;&lt;/p&gt;

&lt;p&gt;Here is how I configured my &lt;code class=&quot;highlighter-rouge&quot;&gt;circle.yml&lt;/code&gt;.&lt;/p&gt;

&lt;h2 id=&quot;before-circle-10-configuration&quot;&gt;Before: Circle 1.0 configuration&lt;/h2&gt;

&lt;p&gt;Circle 1.0 configuration is very simple.&lt;/p&gt;

&lt;div class=&quot;language-yml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;# circle.yml&lt;/span&gt;
&lt;span class=&quot;na&quot;&gt;machine&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;ruby&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;version&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;2.4.1&lt;/span&gt;
&lt;span class=&quot;na&quot;&gt;general&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;artifacts&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;coverage&lt;/span&gt;
    &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;tmp/capybara&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;after-circle-20-configuration&quot;&gt;After: Circle 2.0 configuration&lt;/h2&gt;

&lt;p&gt;Circle 2.0 configuration becomes a bit overwhelming, but I’ll explain it one by one.&lt;/p&gt;

&lt;div class=&quot;language-yml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;# .circleci/config.yml&lt;/span&gt;
&lt;span class=&quot;na&quot;&gt;jobs&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;build&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;working_directory&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;~/app&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;docker&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;image&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;circleci/ruby:2.5-node-browsers&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;environment&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
          &lt;span class=&quot;na&quot;&gt;RAILS_ENV&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;test&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;steps&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;checkout&lt;/span&gt;
      &lt;span class=&quot;c1&quot;&gt;# Restore bundle cache&lt;/span&gt;
      &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;cache-restore&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;key&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;bundle-{{ checksum &quot;Gemfile.lock&quot; }}&lt;/span&gt;
      &lt;span class=&quot;c1&quot;&gt;# Bundle install dependencies&lt;/span&gt;
      &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;bundle install --path vendor/bundle&lt;/span&gt;
      &lt;span class=&quot;c1&quot;&gt;# Store bundle cache&lt;/span&gt;
      &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;cache-save&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;key&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;bundle-{{ checksum &quot;Gemfile.lock&quot; }}&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
          &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;vendor/bundle&lt;/span&gt;
      &lt;span class=&quot;c1&quot;&gt;# Database setup&lt;/span&gt;
      &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;bundle exec rails db:create db:schema:load&lt;/span&gt;
      &lt;span class=&quot;c1&quot;&gt;# RSpec&lt;/span&gt;
      &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;bundle exec rspec&lt;/span&gt;
      &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;store_artifacts&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
          &lt;span class=&quot;na&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;coverage&lt;/span&gt;
      &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;store_artifacts&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
          &lt;span class=&quot;na&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;tmp/capybara&lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;working-directory&quot;&gt;Working Directory&lt;/h3&gt;

&lt;p&gt;First of all, set your &lt;code class=&quot;highlighter-rouge&quot;&gt;working_directory&lt;/code&gt;, any name is okay.&lt;/p&gt;

&lt;div class=&quot;language-yml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;na&quot;&gt;working_directory&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;~/app&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;docker-image&quot;&gt;docker image&lt;/h3&gt;

&lt;p&gt;Then, you need to specify base docker image on CircleCI 2. In this case, I used CircleCI official docker image listed &lt;a href=&quot;https://hub.docker.com/r/circleci/ruby/tags/&quot;&gt;here&lt;/a&gt;(All available images are listed &lt;a href=&quot;https://hub.docker.com/u/circleci/&quot;&gt;here&lt;/a&gt;).&lt;/p&gt;

&lt;div class=&quot;language-yml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;na&quot;&gt;docker&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;image&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;circleci/ruby:2.5-node-browsers&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;environment&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;na&quot;&gt;RAILS_ENV&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;test&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;In &lt;code class=&quot;highlighter-rouge&quot;&gt;environment&lt;/code&gt; section, I configured environment variables for the base image.&lt;/p&gt;

&lt;h3 id=&quot;repository-checkout&quot;&gt;Repository checkout&lt;/h3&gt;

&lt;p&gt;This line means checkout your code base from the repository.&lt;/p&gt;

&lt;div class=&quot;language-yml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;checkout&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;bundle-cache-configuration&quot;&gt;Bundle cache configuration&lt;/h3&gt;

&lt;p&gt;As of CircleCI 2, you need to configured cache setting by yourself. In my Rails project, bundler is used, so I configured bundle install cache as the following.&lt;/p&gt;

&lt;div class=&quot;language-yml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;# Restore bundle cache&lt;/span&gt;
&lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;cache-restore&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;key&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;bundle-{{ checksum &quot;Gemfile.lock&quot; }}&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Bundle install dependencies&lt;/span&gt;
&lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;bundle install --path vendor/bundle&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Store bundle cache&lt;/span&gt;
&lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;cache-save&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;key&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;bundle-{{ checksum &quot;Gemfile.lock&quot; }}&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;vendor/bundle&lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;rails-testing&quot;&gt;Rails testing&lt;/h3&gt;

&lt;p&gt;Rails database setup and runnning RSpec:&lt;/p&gt;

&lt;div class=&quot;language-yml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;# Database setup&lt;/span&gt;
&lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;bundle exec rails db:create db:schema:load&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# RSpec&lt;/span&gt;
&lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;bundle exec rspec&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;phantomjs&quot;&gt;PhantomJS&lt;/h3&gt;

&lt;p&gt;&lt;strong&gt;Update: If you use &lt;code class=&quot;highlighter-rouge&quot;&gt;circleci/ruby:2.5-node-browsers&lt;/code&gt; docker image, PhantomJS is bundled in the image. Therefore, you don’t have to follow the following step.&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;&lt;del&gt;I used &lt;a href=&quot;https://github.com/teampoltergeist/poltergeist&quot;&gt;poltergeist&lt;/a&gt; as a Capybara javascript driver. It requires PhantomJS as a dependency but official Ruby docker image doesn’t include PhantomJS, so I needed to install PhantomJS by myself.&lt;/del&gt;&lt;/p&gt;

&lt;div class=&quot;language-yml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;Install PhantomJS&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;command&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;pi&quot;&gt;|&lt;/span&gt;
      &lt;span class=&quot;no&quot;&gt;mkdir -p ~/.phantomjs/${PHANTOM_JS_VERSION}&lt;/span&gt;
      &lt;span class=&quot;no&quot;&gt;curl -L --output ~/.phantomjs/${PHANTOM_JS_VERSION}/phantomjs.tar.bz2 https://bitbucket.org/ariya/phantomjs/downloads/phantomjs-${PHANTOM_JS_VERSION}-linux-x86_64.tar.bz2&lt;/span&gt;
      &lt;span class=&quot;no&quot;&gt;tar xfvj ~/.phantomjs/${PHANTOM_JS_VERSION}/phantomjs.tar.bz2 -C ~/.phantomjs/${PHANTOM_JS_VERSION}/&lt;/span&gt;
      &lt;span class=&quot;no&quot;&gt;chmod ugo+x ~/.phantomjs/${PHANTOM_JS_VERSION}/phantomjs-${PHANTOM_JS_VERSION}-linux-x86_64/bin/phantomjs&lt;/span&gt;
      &lt;span class=&quot;no&quot;&gt;sudo ln -sf ~/.phantomjs/${PHANTOM_JS_VERSION}/phantomjs-${PHANTOM_JS_VERSION}-linux-x86_64/bin/phantomjs /usr/local/bin/phantomjs&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;del&gt;I created environment variable of PhantomJS version(&lt;code class=&quot;highlighter-rouge&quot;&gt;PHANTOM_JS_VERSION&lt;/code&gt;) so that we can upgrade PhantomJS version easily.&lt;/del&gt;&lt;/p&gt;

&lt;h3 id=&quot;artifacts&quot;&gt;Artifacts&lt;/h3&gt;

&lt;p&gt;You can upload artifacts by specifying &lt;code class=&quot;highlighter-rouge&quot;&gt;store_artifacts&lt;/code&gt; and the &lt;code class=&quot;highlighter-rouge&quot;&gt;path&lt;/code&gt;.&lt;/p&gt;

&lt;div class=&quot;language-yml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;store_artifacts&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;coverage&lt;/span&gt;
&lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;store_artifacts&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;tmp/capybara&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;comparison&quot;&gt;Comparison&lt;/h2&gt;

&lt;p&gt;&lt;amp-img src=&quot;/images/circleci2-2.png&quot; alt=&quot;circleci 1 to 2&quot; width='1400' height='274' layout='responsive'&gt;&lt;/amp-img&gt;&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;CircleCI 1.0 Phase&lt;/th&gt;
      &lt;th&gt;&lt;a href=&quot;https://circleci.com/gh/toshimaru/RailsTwitterClone/197&quot;&gt;CircleCI 1.0&lt;/a&gt;&lt;/th&gt;
      &lt;th&gt;&lt;a href=&quot;https://circleci.com/gh/toshimaru/RailsTwitterClone/264&quot;&gt;CircleCI 2.0&lt;/a&gt;&lt;/th&gt;
      &lt;th&gt;improvement&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;INFRASTRUCTURE&lt;/td&gt;
      &lt;td&gt;25 sec&lt;/td&gt;
      &lt;td&gt;1 sec&lt;/td&gt;
      &lt;td&gt;&lt;strong class=&quot;green&quot;&gt;25x faster&lt;/strong&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;CHECKOUT&lt;/td&gt;
      &lt;td&gt;10 sec&lt;/td&gt;
      &lt;td&gt;1 sec&lt;/td&gt;
      &lt;td&gt;&lt;strong class=&quot;green&quot;&gt;10x faster&lt;/strong&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;MACHINE(cache restore)&lt;/td&gt;
      &lt;td&gt;15 sec&lt;/td&gt;
      &lt;td&gt;3 sec&lt;/td&gt;
      &lt;td&gt;&lt;strong class=&quot;green&quot;&gt;5x faster&lt;/strong&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;DEPENDENCIES(bundle install)&lt;/td&gt;
      &lt;td&gt;6 sec&lt;/td&gt;
      &lt;td&gt;1 sec&lt;/td&gt;
      &lt;td&gt;&lt;strong class=&quot;green&quot;&gt;6x faster&lt;/strong&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;DATABASE&lt;/td&gt;
      &lt;td&gt;11 sec&lt;/td&gt;
      &lt;td&gt;6 sec&lt;/td&gt;
      &lt;td&gt;&lt;strong class=&quot;green&quot;&gt;2x faseter&lt;/strong&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;TEST(RSpec)&lt;/td&gt;
      &lt;td&gt;20 sec&lt;/td&gt;
      &lt;td&gt;22 sec&lt;/td&gt;
      &lt;td&gt;-&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;TEARDOWN(artifacts)&lt;/td&gt;
      &lt;td&gt;26 sec&lt;/td&gt;
      &lt;td&gt;1 sec&lt;/td&gt;
      &lt;td&gt;&lt;strong class=&quot;green&quot;&gt;26x fasetr&lt;/strong&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;strong&gt;Total build time on CircleCI&lt;/strong&gt;&lt;/td&gt;
      &lt;td&gt;&lt;strong&gt;02:02&lt;/strong&gt;&lt;/td&gt;
      &lt;td&gt;&lt;strong&gt;00:40&lt;/strong&gt;&lt;/td&gt;
      &lt;td&gt;&lt;strong class=&quot;green&quot;&gt;3x faster&lt;/strong&gt;&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;* 0 sec is rounded to 1 sec&lt;/p&gt;

&lt;h2 id=&quot;conclusion&quot;&gt;Conclusion&lt;/h2&gt;

&lt;p&gt;CircleCI 2.0 is much faster than CircleCI 1.0. Although CircleCI 2 configuration looks complex, it gives you flexibility and better CI experience. It’ll be worth it.&lt;/p&gt;

&lt;h2 id=&quot;resources&quot;&gt;Resources&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://github.com/toshimaru/RailsTwitterClone/pull/80&quot;&gt;CircleCI 2 by toshimaru · Pull Request #80 · toshimaru/RailsTwitterClone&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://circleci.com/gh/toshimaru/RailsTwitterClone/tree/master&quot;&gt;CircleCI: master branch CI build time&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://github.com/toshimaru/RailsTwitterClone/blob/master/.circleci/config.yml&quot;&gt;My latest config.yml for CircleCI&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://circleci.com/docs/2.0/&quot;&gt;2.0 Docs - CircleCI&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content><author><name>toshimaru</name></author><category term="circleci" /><summary type="html">CircleCI 2 has been released, which makes your CI faster and flexible.</summary></entry></feed>