<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://jekyllrb.com/" version="3.6.0">Jekyll</generator><link href="http://blog.toshima.ru/feed.xml" rel="self" type="application/atom+xml" /><link href="http://blog.toshima.ru/" rel="alternate" type="text/html" /><updated>2017-10-04T02:37:19+09:00</updated><id>http://blog.toshima.ru/</id><title type="html">Toshimaru’s Blog</title><subtitle>Where there's a will, there's a way.
</subtitle><author><name>{&quot;twitter&quot;=&gt;&quot;toshimaru_e&quot;}</name></author><entry><title type="html">Check SSL Certificate Expiration Date via Command Line</title><link href="http://blog.toshima.ru/2017/09/22/ssl-expiration-check-via-command-line.html" rel="alternate" type="text/html" title="Check SSL Certificate Expiration Date via Command Line" /><published>2017-09-22T00:00:00+09:00</published><updated>2017-09-22T00:00:00+09:00</updated><id>http://blog.toshima.ru/2017/09/22/ssl-expiration-check-via-command-line</id><content type="html" xml:base="http://blog.toshima.ru/2017/09/22/ssl-expiration-check-via-command-line.html">&lt;p&gt;If you wanna check SSL certificate expiration date for specific domain via command line, you can use &lt;code class=&quot;highlighter-rouge&quot;&gt;openssl&lt;/code&gt; command.&lt;/p&gt;

&lt;p&gt;Let’s check &lt;code class=&quot;highlighter-rouge&quot;&gt;google.com:443&lt;/code&gt; certificate expiration date using &lt;code class=&quot;highlighter-rouge&quot;&gt;openssl&lt;/code&gt;.&lt;/p&gt;

&lt;div class=&quot;language-console highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;gp&quot;&gt;$&lt;/span&gt; openssl s_client &lt;span class=&quot;nt&quot;&gt;-connect&lt;/span&gt; google.com:443 &amp;lt; /dev/null 2&amp;gt; /dev/null | openssl x509 &lt;span class=&quot;nt&quot;&gt;-text&lt;/span&gt; | &lt;span class=&quot;nb&quot;&gt;grep&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;After&quot;&lt;/span&gt;
&lt;span class=&quot;go&quot;&gt;            Not After : Dec  6 17:09:00 2017 GMT
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;Dec  6 17:09:00 2017 GMT&lt;/code&gt; is expiration date.&lt;/p&gt;

&lt;h2 id=&quot;reference&quot;&gt;Reference&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://www.shellhacks.com/openssl-check-ssl-certificate-expiration-date/&quot;&gt;OpenSSL: Check SSL Certificate Expiration Date and More - ShellHacks&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;[Japanese] &lt;a href=&quot;https://blog.manabusakai.com/2016/07/lambda-cert-expire/&quot;&gt;Lambda を使って SSL サーバ証明書の有効期限をチェックする&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content><author><name>{&quot;twitter&quot;=&gt;&quot;toshimaru_e&quot;}</name></author><category term="ssl" /><category term="bash" /><summary type="html">If you wanna check SSL certificate expiration date for specific domain via command line, you can use openssl command.</summary></entry><entry><title type="html">CircleCI 2 speeds up your CI build time drastically</title><link href="http://blog.toshima.ru/2017/08/18/circleci2-speeds-up-your-ci-time.html" rel="alternate" type="text/html" title="CircleCI 2 speeds up your CI build time drastically" /><published>2017-08-18T00:00:00+09:00</published><updated>2017-08-18T00:00:00+09:00</updated><id>http://blog.toshima.ru/2017/08/18/circleci2-speeds-up-your-ci-time</id><content type="html" xml:base="http://blog.toshima.ru/2017/08/18/circleci2-speeds-up-your-ci-time.html">&lt;p&gt;&lt;a href=&quot;https://circleci.com/blog/launching-today-circleci-2-0-reaches-general-availability/&quot;&gt;CircleCI 2 has been released&lt;/a&gt;, which makes your CI faster and flexible.&lt;/p&gt;

&lt;p&gt;I’ve accomplished 3 times faster CI build time on &lt;a href=&quot;https://github.com/toshimaru/RailsTwitterClone&quot;&gt;my public project&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;&lt;img src=&quot;/images/circleci2.png&quot; alt=&quot;faster build time&quot; /&gt;&lt;/p&gt;

&lt;p&gt;Here is how I configured my &lt;code class=&quot;highlighter-rouge&quot;&gt;circle.yml&lt;/code&gt;.&lt;/p&gt;

&lt;h2 id=&quot;before-circle-10-configuration&quot;&gt;Before: Circle 1.0 configuration&lt;/h2&gt;

&lt;p&gt;Circle 1.0 configuration is very simple.&lt;/p&gt;

&lt;div class=&quot;language-yml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;# circle.yml&lt;/span&gt;
&lt;span class=&quot;na&quot;&gt;machine&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;ruby&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;version&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;2.4.1&lt;/span&gt;
&lt;span class=&quot;na&quot;&gt;general&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;artifacts&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;coverage&lt;/span&gt;
    &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;tmp/capybara&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;after-circle-20-configuration&quot;&gt;After: Circle 2.0 configuration&lt;/h2&gt;

&lt;p&gt;Circle 2.0 configuration becomes a bit overwhelming, but I’ll explain it one by one.&lt;/p&gt;

&lt;div class=&quot;language-yml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;# .circleci/config.yml&lt;/span&gt;
&lt;span class=&quot;na&quot;&gt;jobs&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;build&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;working_directory&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;~/app&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;docker&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;image&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;circleci/ruby:2.4-node&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;environment&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
          &lt;span class=&quot;na&quot;&gt;RAILS_ENV&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;test&lt;/span&gt;
          &lt;span class=&quot;na&quot;&gt;PHANTOM_JS_VERSION&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;2.1.1&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;steps&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;checkout&lt;/span&gt;
      &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
          &lt;span class=&quot;na&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;Install PhantomJS&lt;/span&gt;
          &lt;span class=&quot;na&quot;&gt;command&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;pi&quot;&gt;|&lt;/span&gt;
            &lt;span class=&quot;no&quot;&gt;mkdir -p ~/.phantomjs/${PHANTOM_JS_VERSION}&lt;/span&gt;
            &lt;span class=&quot;no&quot;&gt;curl -L --output ~/.phantomjs/${PHANTOM_JS_VERSION}/phantomjs.tar.bz2 https://bitbucket.org/ariya/phantomjs/downloads/phantomjs-${PHANTOM_JS_VERSION}-linux-x86_64.tar.bz2&lt;/span&gt;
            &lt;span class=&quot;no&quot;&gt;tar xfvj ~/.phantomjs/${PHANTOM_JS_VERSION}/phantomjs.tar.bz2 -C ~/.phantomjs/${PHANTOM_JS_VERSION}/&lt;/span&gt;
            &lt;span class=&quot;no&quot;&gt;chmod ugo+x ~/.phantomjs/${PHANTOM_JS_VERSION}/phantomjs-${PHANTOM_JS_VERSION}-linux-x86_64/bin/phantomjs&lt;/span&gt;
            &lt;span class=&quot;no&quot;&gt;sudo ln -sf ~/.phantomjs/${PHANTOM_JS_VERSION}/phantomjs-${PHANTOM_JS_VERSION}-linux-x86_64/bin/phantomjs /usr/local/bin/phantomjs&lt;/span&gt;
      &lt;span class=&quot;c1&quot;&gt;# Restore bundle cache&lt;/span&gt;
      &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;cache-restore&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;key&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;bundle-{{ checksum &quot;Gemfile.lock&quot; }}&lt;/span&gt;
      &lt;span class=&quot;c1&quot;&gt;# Bundle install dependencies&lt;/span&gt;
      &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;bundle install --path vendor/bundle&lt;/span&gt;
      &lt;span class=&quot;c1&quot;&gt;# Store bundle cache&lt;/span&gt;
      &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;cache-save&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;key&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;bundle-{{ checksum &quot;Gemfile.lock&quot; }}&lt;/span&gt;
        &lt;span class=&quot;na&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
          &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;vendor/bundle&lt;/span&gt;
      &lt;span class=&quot;c1&quot;&gt;# Database setup&lt;/span&gt;
      &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;bundle exec rails db:create db:schema:load&lt;/span&gt;
      &lt;span class=&quot;c1&quot;&gt;# RSpec&lt;/span&gt;
      &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;bundle exec rspec&lt;/span&gt;
      &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;store_artifacts&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
          &lt;span class=&quot;na&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;coverage&lt;/span&gt;
      &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;store_artifacts&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
          &lt;span class=&quot;na&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;tmp/capybara&lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;working-directory&quot;&gt;Working Directory&lt;/h3&gt;

&lt;p&gt;First of all, set your &lt;code class=&quot;highlighter-rouge&quot;&gt;working_directory&lt;/code&gt;, any name is okay.&lt;/p&gt;

&lt;div class=&quot;language-yml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;na&quot;&gt;working_directory&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;~/app&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;docker-image&quot;&gt;docker image&lt;/h3&gt;

&lt;p&gt;Then, you need to specify base docker image on CircleCI 2. In this case, I used CircleCI official docker image listed &lt;a href=&quot;https://hub.docker.com/r/circleci/ruby/tags/&quot;&gt;here&lt;/a&gt;(All available images are listed &lt;a href=&quot;https://hub.docker.com/u/circleci/&quot;&gt;here&lt;/a&gt;).&lt;/p&gt;

&lt;div class=&quot;language-yml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;na&quot;&gt;docker&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
  &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;image&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;circleci/ruby:2.4-node&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;environment&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
      &lt;span class=&quot;na&quot;&gt;RAILS_ENV&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;test&lt;/span&gt;
      &lt;span class=&quot;na&quot;&gt;PHANTOM_JS_VERSION&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;2.1.1&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;In &lt;code class=&quot;highlighter-rouge&quot;&gt;environment&lt;/code&gt; section, I configured environment variables for the base image.&lt;/p&gt;

&lt;h3 id=&quot;repository-checkout&quot;&gt;Repository checkout&lt;/h3&gt;

&lt;p&gt;This line means checkout your code base from the repository.&lt;/p&gt;

&lt;div class=&quot;language-yml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;checkout&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;bundle-cache-configuration&quot;&gt;Bundle cache configuration&lt;/h3&gt;

&lt;p&gt;As of CircleCI 2, you need to configured cache setting by yourself. In my Rails project, bundler is used, so I configured bundle install cache as below.&lt;/p&gt;

&lt;div class=&quot;language-yml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;# Restore bundle cache&lt;/span&gt;
&lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;cache-restore&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;key&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;bundle-{{ checksum &quot;Gemfile.lock&quot; }}&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Bundle install dependencies&lt;/span&gt;
&lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;bundle install --path vendor/bundle&lt;/span&gt;

&lt;span class=&quot;c1&quot;&gt;# Store bundle cache&lt;/span&gt;
&lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;type&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;cache-save&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;key&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;bundle-{{ checksum &quot;Gemfile.lock&quot; }}&lt;/span&gt;
  &lt;span class=&quot;na&quot;&gt;paths&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;vendor/bundle&lt;/span&gt;

&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;rails-testing&quot;&gt;Rails testing&lt;/h3&gt;

&lt;p&gt;Rails database setup and runnning RSpec:&lt;/p&gt;

&lt;div class=&quot;language-yml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;# Database setup&lt;/span&gt;
&lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;bundle exec rails db:create db:schema:load&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;# RSpec&lt;/span&gt;
&lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;bundle exec rspec&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h4 id=&quot;phantomjs&quot;&gt;PhantomJS&lt;/h4&gt;

&lt;p&gt;I used &lt;a href=&quot;https://github.com/teampoltergeist/poltergeist&quot;&gt;poltergeist&lt;/a&gt; as a Capybara javascript driver. It requires PhantomJS as a dependency but official Ruby docker image doesn’t include PhantomJS, so I needed to install PhantomJS by myself.&lt;/p&gt;

&lt;div class=&quot;language-yml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;run&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;Install PhantomJS&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;command&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;pi&quot;&gt;|&lt;/span&gt;
      &lt;span class=&quot;no&quot;&gt;mkdir -p ~/.phantomjs/${PHANTOM_JS_VERSION}&lt;/span&gt;
      &lt;span class=&quot;no&quot;&gt;curl -L --output ~/.phantomjs/${PHANTOM_JS_VERSION}/phantomjs.tar.bz2 https://bitbucket.org/ariya/phantomjs/downloads/phantomjs-${PHANTOM_JS_VERSION}-linux-x86_64.tar.bz2&lt;/span&gt;
      &lt;span class=&quot;no&quot;&gt;tar xfvj ~/.phantomjs/${PHANTOM_JS_VERSION}/phantomjs.tar.bz2 -C ~/.phantomjs/${PHANTOM_JS_VERSION}/&lt;/span&gt;
      &lt;span class=&quot;no&quot;&gt;chmod ugo+x ~/.phantomjs/${PHANTOM_JS_VERSION}/phantomjs-${PHANTOM_JS_VERSION}-linux-x86_64/bin/phantomjs&lt;/span&gt;
      &lt;span class=&quot;no&quot;&gt;sudo ln -sf ~/.phantomjs/${PHANTOM_JS_VERSION}/phantomjs-${PHANTOM_JS_VERSION}-linux-x86_64/bin/phantomjs /usr/local/bin/phantomjs&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I created environment variable of PhantomJS version(&lt;code class=&quot;highlighter-rouge&quot;&gt;PHANTOM_JS_VERSION&lt;/code&gt;) so that we can upgrade PhantomJS version easily.&lt;/p&gt;

&lt;h3 id=&quot;artifacts&quot;&gt;Artifacts&lt;/h3&gt;

&lt;p&gt;You can upload artifacts by specifying &lt;code class=&quot;highlighter-rouge&quot;&gt;store_artifacts&lt;/code&gt; and the &lt;code class=&quot;highlighter-rouge&quot;&gt;path&lt;/code&gt;.&lt;/p&gt;

&lt;div class=&quot;language-yml highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;store_artifacts&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;coverage&lt;/span&gt;
&lt;span class=&quot;pi&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;na&quot;&gt;store_artifacts&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt;
    &lt;span class=&quot;na&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;pi&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s&quot;&gt;tmp/capybara&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;comparison&quot;&gt;Comparison&lt;/h2&gt;

&lt;p&gt;&lt;img src=&quot;/images/circleci2-2.png&quot; alt=&quot;circleci 1 to 2&quot; /&gt;&lt;/p&gt;

&lt;table&gt;
  &lt;thead&gt;
    &lt;tr&gt;
      &lt;th&gt;CircleCI 1.0 Phase&lt;/th&gt;
      &lt;th&gt;&lt;a href=&quot;https://circleci.com/gh/toshimaru/RailsTwitterClone/197&quot;&gt;CircleCI 1.0&lt;/a&gt;&lt;/th&gt;
      &lt;th&gt;&lt;a href=&quot;https://circleci.com/gh/toshimaru/RailsTwitterClone/264&quot;&gt;CircleCI 2.0&lt;/a&gt;&lt;/th&gt;
      &lt;th&gt;improvement&lt;/th&gt;
    &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
    &lt;tr&gt;
      &lt;td&gt;INFRASTRUCTURE&lt;/td&gt;
      &lt;td&gt;25sec&lt;/td&gt;
      &lt;td&gt;1sec&lt;/td&gt;
      &lt;td&gt;&lt;strong class=&quot;green&quot;&gt;25x faster&lt;/strong&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;CHECKOUT&lt;/td&gt;
      &lt;td&gt;10sec&lt;/td&gt;
      &lt;td&gt;1sec&lt;/td&gt;
      &lt;td&gt;&lt;strong class=&quot;green&quot;&gt;10x faster&lt;/strong&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;MACHINE(cache restore)&lt;/td&gt;
      &lt;td&gt;15sec&lt;/td&gt;
      &lt;td&gt;3sec&lt;/td&gt;
      &lt;td&gt;&lt;strong class=&quot;green&quot;&gt;5x faster&lt;/strong&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;DEPENDENCIES(bundle install)&lt;/td&gt;
      &lt;td&gt;6sec&lt;/td&gt;
      &lt;td&gt;1sec&lt;/td&gt;
      &lt;td&gt;&lt;strong class=&quot;green&quot;&gt;6x faster&lt;/strong&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;DATABASE&lt;/td&gt;
      &lt;td&gt;11sec&lt;/td&gt;
      &lt;td&gt;6sec&lt;/td&gt;
      &lt;td&gt;&lt;strong class=&quot;green&quot;&gt;2x faseter&lt;/strong&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;TEST(RSpec)&lt;/td&gt;
      &lt;td&gt;20sec&lt;/td&gt;
      &lt;td&gt;22sec&lt;/td&gt;
      &lt;td&gt;-&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;TEARDOWN(artifacts)&lt;/td&gt;
      &lt;td&gt;26sec&lt;/td&gt;
      &lt;td&gt;1sec&lt;/td&gt;
      &lt;td&gt;&lt;strong class=&quot;green&quot;&gt;26x fasetr&lt;/strong&gt;&lt;/td&gt;
    &lt;/tr&gt;
    &lt;tr&gt;
      &lt;td&gt;&lt;strong&gt;Total build time on CircleCI&lt;/strong&gt;&lt;/td&gt;
      &lt;td&gt;&lt;strong&gt;02:02&lt;/strong&gt;&lt;/td&gt;
      &lt;td&gt;&lt;strong&gt;00:40&lt;/strong&gt;&lt;/td&gt;
      &lt;td&gt;&lt;strong class=&quot;green&quot;&gt;3x faster&lt;/strong&gt;&lt;/td&gt;
    &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;

&lt;p&gt;* 0sec is rounded to 1sec&lt;/p&gt;

&lt;h2 id=&quot;conclusion&quot;&gt;Conclusion&lt;/h2&gt;

&lt;p&gt;CircleCI 2.0 is much faster than CircleCI 1.0. Although CircleCI 2 configuration looks complex, it gives you flexibility and better CI experience. It’ll be worth it.&lt;/p&gt;

&lt;h2 id=&quot;resources&quot;&gt;Resources&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://github.com/toshimaru/RailsTwitterClone/pull/80&quot;&gt;CircleCI 2 by toshimaru · Pull Request #80 · toshimaru/RailsTwitterClone&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://circleci.com/gh/toshimaru/RailsTwitterClone/tree/master&quot;&gt;CircleCI: master branch CI build time&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://github.com/toshimaru/RailsTwitterClone/blob/master/.circleci/config.yml&quot;&gt;My latest config.yml for CircleCI&lt;/a&gt;&lt;/li&gt;
  &lt;li&gt;&lt;a href=&quot;https://circleci.com/docs/2.0/&quot;&gt;2.0 Docs - CircleCI&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content><author><name>{&quot;twitter&quot;=&gt;&quot;toshimaru_e&quot;}</name></author><category term="circleci" /><summary type="html">CircleCI 2 has been released, which makes your CI faster and flexible.</summary></entry><entry><title type="html">Get started with docker on Mac</title><link href="http://blog.toshima.ru/2017/08/16/docker-getting-started-on-mac.html" rel="alternate" type="text/html" title="Get started with docker on Mac" /><published>2017-08-16T00:00:00+09:00</published><updated>2017-08-16T00:00:00+09:00</updated><id>http://blog.toshima.ru/2017/08/16/docker-getting-started-on-mac</id><content type="html" xml:base="http://blog.toshima.ru/2017/08/16/docker-getting-started-on-mac.html">&lt;p&gt;Let’s get started with docker on Mac.&lt;/p&gt;

&lt;h2 id=&quot;install-docker&quot;&gt;Install Docker&lt;/h2&gt;

&lt;p&gt;First of all, install docker.&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ brew install docker
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Then, run &lt;code class=&quot;highlighter-rouge&quot;&gt;docker info&lt;/code&gt; to make sure &lt;a href=&quot;https://docs.docker.com/&quot;&gt;docker&lt;/a&gt; is installed.&lt;/p&gt;

&lt;div class=&quot;language-console highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;gp&quot;&gt;$&lt;/span&gt; docker info
&lt;span class=&quot;go&quot;&gt;Cannot connect to the Docker daemon at unix:///var/run/docker.sock. Is the docker daemon running?
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Hmm, docker is installed, but it gets error.&lt;/p&gt;

&lt;h2 id=&quot;install-docker-machine&quot;&gt;Install Docker Machine&lt;/h2&gt;

&lt;p&gt;To solve this, we need to create a machine for Docker. let’s install &lt;a href=&quot;https://docs.docker.com/machine/&quot;&gt;docker-machine&lt;/a&gt; with &lt;a href=&quot;https://www.virtualbox.org/&quot;&gt;virtualbox&lt;/a&gt;.&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ brew install docker-machine
$ brew cask install virtualbox
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;create-docker-machine-on-mac&quot;&gt;Create Docker Machine on Mac&lt;/h2&gt;

&lt;p&gt;Okay, then, create default machine with virtualbox driver.&lt;/p&gt;

&lt;div class=&quot;language-console highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;gp&quot;&gt;$&lt;/span&gt; docker-machine create &lt;span class=&quot;nt&quot;&gt;--driver&lt;/span&gt; virtualbox default
&lt;span class=&quot;go&quot;&gt;Running pre-create checks...
Creating machine...
(default) Copying /Users/toshimaru/.docker/machine/cache/boot2docker.iso to /Users/toshimaru/.docker/machine/machines/default/boot2docker.iso...
(default) Creating VirtualBox VM...
(default) Creating SSH key...
(default) Starting the VM...
(default) Check network to re-create if needed...
(default) Waiting for an IP...
Waiting for machine to be running, this may take a few minutes...
Detecting operating system of created instance...
Waiting for SSH to be available...
Detecting the provisioner...
Provisioning with boot2docker...
Copying certs to the local machine directory...
Copying certs to the remote machine...
Setting Docker configuration on the remote daemon...
Checking connection to Docker...
Docker is up and running!
To see how to connect your Docker Client to the Docker Engine running on this virtual machine, run: docker-machine env default
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;It says:&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;run: docker-machine env default&lt;/p&gt;
&lt;/blockquote&gt;

&lt;div class=&quot;language-console highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;gp&quot;&gt;$&lt;/span&gt; docker-machine env default
&lt;span class=&quot;go&quot;&gt;export DOCKER_TLS_VERIFY=&quot;1&quot;
export DOCKER_HOST=&quot;tcp://192.168.x.x:xxxx&quot;
export DOCKER_CERT_PATH=&quot;/Users/toshimaru/.docker/machine/machines/default&quot;
export DOCKER_MACHINE_NAME=&quot;default&quot;
&lt;/span&gt;&lt;span class=&quot;gp&quot;&gt;#&lt;/span&gt; Run this &lt;span class=&quot;nb&quot;&gt;command &lt;/span&gt;to configure your shell:
&lt;span class=&quot;gp&quot;&gt;#&lt;/span&gt; &lt;span class=&quot;nb&quot;&gt;eval&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;$(&lt;/span&gt;docker-machine env default&lt;span class=&quot;k&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The output says:&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;Run this command to configure your shell:&lt;/p&gt;
&lt;/blockquote&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ eval $(docker-machine env default)
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;docker-is-ready&quot;&gt;Docker is ready&lt;/h2&gt;

&lt;p&gt;Docker is ready to run.&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ docker info
Containers: 0
 Running: 0
 Paused: 0
 Stopped: 0
Images: 0
Server Version: 17.06.0-ce
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Yay! docker command finally works!&lt;/p&gt;

&lt;h2 id=&quot;docker-status&quot;&gt;Docker Status&lt;/h2&gt;

&lt;h3 id=&quot;docker-machine-status&quot;&gt;docker-machine status&lt;/h3&gt;

&lt;div class=&quot;language-console highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;gp&quot;&gt;$&lt;/span&gt; docker-machine status
&lt;span class=&quot;go&quot;&gt;Running
&lt;/span&gt;&lt;span class=&quot;gp&quot;&gt;$&lt;/span&gt; docker-machine &lt;span class=&quot;nb&quot;&gt;ls&lt;/span&gt;
&lt;span class=&quot;go&quot;&gt;NAME      ACTIVE   DRIVER       STATE     URL                         SWARM   DOCKER        ERRORS
default   -        virtualbox   Running   tcp://192.x.x.x:xxx           v17.06.0-ce
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;docker-status-1&quot;&gt;docker status&lt;/h3&gt;

&lt;div class=&quot;language-console highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;gp&quot;&gt;$&lt;/span&gt; docker ps
&lt;span class=&quot;go&quot;&gt;CONTAINER ID        IMAGE               COMMAND             CREATED             STATUS              PORTS               NAMES
&lt;/span&gt;&lt;span class=&quot;c&quot;&gt;...
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;</content><author><name>{&quot;twitter&quot;=&gt;&quot;toshimaru_e&quot;}</name></author><category term="docker" /><category term="mac" /><summary type="html">Let’s get started with docker on Mac.</summary></entry><entry><title type="html">Show SQL queries in rails console</title><link href="http://blog.toshima.ru/2017/08/10/show-sql-in-rails-console.html" rel="alternate" type="text/html" title="Show SQL queries in rails console" /><published>2017-08-10T00:00:00+09:00</published><updated>2017-08-10T00:00:00+09:00</updated><id>http://blog.toshima.ru/2017/08/10/show-sql-in-rails-console</id><content type="html" xml:base="http://blog.toshima.ru/2017/08/10/show-sql-in-rails-console.html">&lt;p&gt;When you set &lt;code class=&quot;highlighter-rouge&quot;&gt;log_level&lt;/code&gt; &lt;code class=&quot;highlighter-rouge&quot;&gt;:info&lt;/code&gt; (mostly on production server), the SQL outputs are disabled in &lt;code class=&quot;highlighter-rouge&quot;&gt;rails console&lt;/code&gt;.&lt;/p&gt;

&lt;div class=&quot;language-rb highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;c1&quot;&gt;# Rails Configuration&lt;/span&gt;
&lt;span class=&quot;no&quot;&gt;Rails&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;application&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;configure&lt;/span&gt; &lt;span class=&quot;k&quot;&gt;do&lt;/span&gt;
  &lt;span class=&quot;o&quot;&gt;...&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;config&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;log_level&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;:info&lt;/span&gt;
  &lt;span class=&quot;o&quot;&gt;...&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-ruby highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;Model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;count&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;12345&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;If you want to see SQL generated by &lt;code class=&quot;highlighter-rouge&quot;&gt;Model.count&lt;/code&gt;, you need to set logger level manually.&lt;/p&gt;

&lt;div class=&quot;language-rb highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;no&quot;&gt;Rails&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;logger&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;level&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;:debug&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;language-rb highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;Rails&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;logger&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;level&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;:debug&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;:debug&lt;/span&gt;

&lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;Model&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nf&quot;&gt;count&lt;/span&gt;
   &lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;mf&quot;&gt;1.8&lt;/span&gt;&lt;span class=&quot;n&quot;&gt;ms&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;  &lt;span class=&quot;no&quot;&gt;SELECT&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;COUNT&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;*&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;FROM&lt;/span&gt; &lt;span class=&quot;sb&quot;&gt;`models`&lt;/span&gt;
&lt;span class=&quot;o&quot;&gt;=&amp;gt;&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;12345&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Now, you can check the queries in &lt;code class=&quot;highlighter-rouge&quot;&gt;rails console&lt;/code&gt;.&lt;/p&gt;

&lt;h2 id=&quot;reference&quot;&gt;Reference&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;http://guides.rubyonrails.org/debugging_rails_applications.html#log-levels&quot;&gt;Log Levels - Debugging Rails Applications — Ruby on Rails Guides&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content><author><name>{&quot;twitter&quot;=&gt;&quot;toshimaru_e&quot;}</name></author><category term="rails" /><summary type="html">When you set log_level :info (mostly on production server), the SQL outputs are disabled in rails console.</summary></entry><entry><title type="html">Using less without word-wrap</title><link href="http://blog.toshima.ru/2017/08/08/less-without-word-wrap.html" rel="alternate" type="text/html" title="Using less without word-wrap" /><published>2017-08-08T00:00:00+09:00</published><updated>2017-08-08T00:00:00+09:00</updated><id>http://blog.toshima.ru/2017/08/08/less-without-word-wrap</id><content type="html" xml:base="http://blog.toshima.ru/2017/08/08/less-without-word-wrap.html">&lt;p&gt;When you open up a file with less, word-wrap is sometimes annoying.&lt;/p&gt;

&lt;div class=&quot;language-terminal highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;gp&quot;&gt;$&lt;/span&gt; less longtext.txt
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;/images/less1.png&quot; alt=&quot;less1&quot; /&gt;&lt;/p&gt;

&lt;p&gt;You can open it without word-wrap by passing &lt;code class=&quot;highlighter-rouge&quot;&gt;-S&lt;/code&gt; option.&lt;/p&gt;

&lt;div class=&quot;language-terminal highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;gp&quot;&gt;$&lt;/span&gt; less &lt;span class=&quot;nt&quot;&gt;-S&lt;/span&gt; longtext.txt
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;img src=&quot;/images/less2.png&quot; alt=&quot;less2&quot; /&gt;&lt;/p&gt;

&lt;h2 id=&quot;reference&quot;&gt;Reference&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://superuser.com/questions/272818/how-to-turn-off-word-wrap-in-less&quot;&gt;linux - How to turn off word-wrap in less - Super User&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content><author><name>{&quot;twitter&quot;=&gt;&quot;toshimaru_e&quot;}</name></author><category term="less" /><category term="linux" /><summary type="html">When you open up a file with less, word-wrap is sometimes annoying.</summary></entry><entry><title type="html">Use saved_change_to_attribute? instead of attribute_changed? as of Rails 5.1</title><link href="http://blog.toshima.ru/2017/04/06/saved-change-to-attribute.html" rel="alternate" type="text/html" title="Use saved_change_to_attribute? instead of attribute_changed? as of Rails 5.1" /><published>2017-04-06T00:00:00+09:00</published><updated>2017-04-06T00:00:00+09:00</updated><id>http://blog.toshima.ru/2017/04/06/saved-change-to-attribute</id><content type="html" xml:base="http://blog.toshima.ru/2017/04/06/saved-change-to-attribute.html">&lt;p&gt;As of &lt;a href=&quot;http://edgeguides.rubyonrails.org/5_1_release_notes.html&quot;&gt;Ruby on Rails 5.1&lt;/a&gt;, &lt;code class=&quot;highlighter-rouge&quot;&gt;attribute_changed?&lt;/code&gt; ActiveRecord method will be deprecated.&lt;/p&gt;

&lt;p&gt;The deprecation message:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;DEPRECATION WARNING: The behavior of `attribute_changed?` inside of after callbacks will be changing in the next version of Rails. The new return value will reflect the behavior of calling the method after `save` returned (e.g. the opposite of what it returns now). To maintain the current behavior, use `saved_change_to_attribute?` instead.
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;As the messages says, using &lt;code class=&quot;highlighter-rouge&quot;&gt;saved_change_to_attribute?&lt;/code&gt; instead of &lt;code class=&quot;highlighter-rouge&quot;&gt;attribute_changed?&lt;/code&gt; is recommended.&lt;/p&gt;

&lt;h2 id=&quot;example&quot;&gt;Example&lt;/h2&gt;

&lt;p&gt;Let’s say you write code like this:&lt;/p&gt;

&lt;div class=&quot;language-rb highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;nc&quot;&gt;Post&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;lt;&lt;/span&gt; &lt;span class=&quot;no&quot;&gt;ApplicationRecord&lt;/span&gt;
  &lt;span class=&quot;n&quot;&gt;after_update&lt;/span&gt; &lt;span class=&quot;ss&quot;&gt;:deprecation_after_update&lt;/span&gt;

  &lt;span class=&quot;k&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;nf&quot;&gt;deprecation_after_update&lt;/span&gt;
    &lt;span class=&quot;c1&quot;&gt;# Post has title column&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;title_changed?&lt;/span&gt;
      &lt;span class=&quot;c1&quot;&gt;# ...&lt;/span&gt;
    &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
  &lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Then you need to rewrite it like this:&lt;/p&gt;

&lt;div class=&quot;language-rb highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;saved_change_to_title?&lt;/span&gt;
  &lt;span class=&quot;c1&quot;&gt;# ...&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;or&lt;/p&gt;

&lt;div class=&quot;language-rb highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;k&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;saved_change_to_attribute?&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;ss&quot;&gt;:title&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;c1&quot;&gt;# ...&lt;/span&gt;
&lt;span class=&quot;k&quot;&gt;end&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;use-attribute_before_last_save-instead-of-attribute_was&quot;&gt;Use &lt;code class=&quot;highlighter-rouge&quot;&gt;attribute_before_last_save&lt;/code&gt; instead of &lt;code class=&quot;highlighter-rouge&quot;&gt;attribute_was&lt;/code&gt;&lt;/h2&gt;

&lt;p&gt;Also, &lt;code class=&quot;highlighter-rouge&quot;&gt;attribute_was&lt;/code&gt; is deprecated in Rails 5.1. which is one of methods in &lt;a href=&quot;http://api.rubyonrails.org/classes/ActiveModel/Dirty.html&quot;&gt;ActiveModel::Dirty&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;The deprecation message is:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;DEPRECATION WARNING: The behavior of `attribute_was` inside of after callbacks will be changing in the next version of Rails. The new return value will reflect the behavior of calling the method after `save` returned (e.g. the opposite of what it returns now). To maintain the current behavior, use `attribute_before_last_save` instead.
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;As message says, we need to replace &lt;code class=&quot;highlighter-rouge&quot;&gt;attribute_was&lt;/code&gt; with &lt;code class=&quot;highlighter-rouge&quot;&gt;attribute_before_last_save&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;For example:&lt;/p&gt;

&lt;div class=&quot;language-diff highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;gd&quot;&gt;-title_was
&lt;/span&gt;&lt;span class=&quot;gi&quot;&gt;+title_before_last_save
&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;why-this-change-needed&quot;&gt;Why this change needed?&lt;/h2&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/sgrif&quot;&gt;sgrif&lt;/a&gt; explains why on GitHub issue: &lt;a href=&quot;https://github.com/rails/rails/pull/25337&quot;&gt;Deprecate the behavior of AR::Dirty inside of after_(create|update|save) callbacks by sgrif · Pull Request #25337 · rails/rails&lt;/a&gt;&lt;/p&gt;</content><author><name>{&quot;twitter&quot;=&gt;&quot;toshimaru_e&quot;}</name></author><category term="rails" /><category term="activerecord" /><summary type="html">As of Ruby on Rails 5.1, attribute_changed? ActiveRecord method will be deprecated.</summary></entry><entry><title type="html">Merge arrays in ES6 way</title><link href="http://blog.toshima.ru/2017/03/24/es6-array-merge.html" rel="alternate" type="text/html" title="Merge arrays in ES6 way" /><published>2017-03-24T00:00:00+09:00</published><updated>2017-03-24T00:00:00+09:00</updated><id>http://blog.toshima.ru/2017/03/24/es6-array-merge</id><content type="html" xml:base="http://blog.toshima.ru/2017/03/24/es6-array-merge.html">&lt;p&gt;How can we merge some arrays in JavaScript?&lt;/p&gt;

&lt;h2 id=&quot;old-way&quot;&gt;Old Way&lt;/h2&gt;

&lt;h3 id=&quot;merge-2-arrays&quot;&gt;Merge 2 Arrays&lt;/h3&gt;

&lt;p&gt;You can use &lt;a href=&quot;https://developer.mozilla.org/ja/docs/Web/JavaScript/Reference/Global_Objects/Array/concat&quot;&gt;concat&lt;/a&gt; to merge arrays.&lt;/p&gt;

&lt;div class=&quot;language-js highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nx&quot;&gt;ary1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;ary2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;ary1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;concat&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;ary2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;// [ 1, 2, 2, 3 ]&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;merge-multiple-arrays&quot;&gt;Merge Multiple Arrays&lt;/h3&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;concat&lt;/code&gt; can take multiple arrays as arguments.&lt;/p&gt;

&lt;div class=&quot;language-js highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nx&quot;&gt;ary1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;concat&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;ary2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;5&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;6&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;7&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;])&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;// [ 1, 2, 2, 3, 5, 6, 7 ]&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h2 id=&quot;es6-way&quot;&gt;ES6 way&lt;/h2&gt;

&lt;p&gt;You can use &lt;a href=&quot;https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Spread_operator&quot;&gt;Spread syntax&lt;/a&gt; to merge arrays in ES6(ES2015). This way is easier and more readable.&lt;/p&gt;

&lt;div class=&quot;language-js highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nx&quot;&gt;ary1&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;ary2&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;mi&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;p&quot;&gt;[...&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;ary1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;ary2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;// [ 1, 2, 2, 3 ]&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;You can merge multiple arrays as much as you want.&lt;/p&gt;

&lt;div class=&quot;language-js highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;p&quot;&gt;[...&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;ary1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;ary2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;...&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;ary3&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;]&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Also, you can use combination of &lt;a href=&quot;https://developer.mozilla.org/ja/docs/Web/JavaScript/Reference/Global_Objects/Array/push&quot;&gt;push&lt;/a&gt; and spread syntax.&lt;/p&gt;

&lt;div class=&quot;language-js highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;nx&quot;&gt;ary1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;push&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(...&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;ary2&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;nx&quot;&gt;console&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;nx&quot;&gt;ary1&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;c1&quot;&gt;// [ 1, 2, 2, 3 ]&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This changes &lt;code class=&quot;highlighter-rouge&quot;&gt;ary1&lt;/code&gt; value, so you should use this way when you want to merge another array into an array. In this case, &lt;code class=&quot;highlighter-rouge&quot;&gt;ary2&lt;/code&gt; is merged into &lt;code class=&quot;highlighter-rouge&quot;&gt;ary1&lt;/code&gt;.&lt;/p&gt;

&lt;h2 id=&quot;reference&quot;&gt;Reference&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;a href=&quot;https://gist.github.com/yesvods/51af798dd1e7058625f4&quot;&gt;Merge Arrays in one with ES6 Array spread&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content><author><name>{&quot;twitter&quot;=&gt;&quot;toshimaru_e&quot;}</name></author><category term="javascript" /><summary type="html">How can we merge some arrays in JavaScript?</summary></entry><entry><title type="html">mysqldump command for existing Rails app</title><link href="http://blog.toshima.ru/2016/12/16/mysqldump-command.html" rel="alternate" type="text/html" title="mysqldump command for existing Rails app" /><published>2016-12-16T00:00:00+09:00</published><updated>2016-12-16T00:00:00+09:00</updated><id>http://blog.toshima.ru/2016/12/16/mysqldump-command</id><content type="html" xml:base="http://blog.toshima.ru/2016/12/16/mysqldump-command.html">&lt;h2 id=&quot;environment&quot;&gt;Environment&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;Rails 5.0.0.1&lt;/li&gt;
&lt;/ul&gt;

&lt;h2 id=&quot;how-to-export-dumpsql-using-mysqldump&quot;&gt;How to export dump.sql using mysqldump&lt;/h2&gt;

&lt;p&gt;The following command generates &lt;code class=&quot;highlighter-rouge&quot;&gt;dump.sql&lt;/code&gt; for existing Rails app.&lt;/p&gt;

&lt;div class=&quot;language-bash highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;mysqldump &lt;span class=&quot;nt&quot;&gt;-u&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;USER_NAME&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-h&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;HOST_NAME&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;-p&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--no-create-info&lt;/span&gt; &lt;span class=&quot;nt&quot;&gt;--ignore-table&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;DATABASE_NAME.schema_migrations &lt;span class=&quot;nt&quot;&gt;--ignore-table&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;=&lt;/span&gt;DATABASE_NAME.ar_internal_metadata &lt;span class=&quot;o&quot;&gt;{&lt;/span&gt;DATABASE_NAME&lt;span class=&quot;o&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;o&quot;&gt;&amp;gt;&lt;/span&gt; dump.sql
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;h3 id=&quot;variables&quot;&gt;Variables&lt;/h3&gt;

&lt;p&gt;Change following variables depending on your environment.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;USER_NAME&lt;/code&gt;: database user name&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;HOST_NAME&lt;/code&gt;: MySQL host name&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;DATABASE_NAME&lt;/code&gt;: your rails app database name&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&quot;command-explanation&quot;&gt;Command explanation&lt;/h3&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;--no-create-info&lt;/code&gt; flag means do not include &lt;code class=&quot;highlighter-rouge&quot;&gt;CREATE TABLE&lt;/code&gt; information. It’s needed because we already have create table information file in Rails &lt;code class=&quot;highlighter-rouge&quot;&gt;schema.rb&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;--ignore-table&lt;/code&gt; is needed to ignore those two tables.&lt;/p&gt;

&lt;ul&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;schema_migrations&lt;/code&gt;: This table has version information(e.g. &lt;code class=&quot;highlighter-rouge&quot;&gt;20161205083433&lt;/code&gt;)&lt;/li&gt;
  &lt;li&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;ar_internal_metadata&lt;/code&gt;: This table has your Rails app environment information&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;These are automatically created by Rails, so you don’t need it.&lt;/p&gt;

&lt;h2 id=&quot;how-to-import-dumpsql&quot;&gt;How to import dump.sql&lt;/h2&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ bundle exec rails db:reset
$ mysql -u root DATABASE_NAME &amp;lt; ./dump.sql
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;</content><author><name>{&quot;twitter&quot;=&gt;&quot;toshimaru_e&quot;}</name></author><category term="mysql" /><category term="rails" /><summary type="html">Environment</summary></entry><entry><title type="html">Display disk usage on macOS with du command</title><link href="http://blog.toshima.ru/2016/11/26/display-disk-usage-command-on-mac.html" rel="alternate" type="text/html" title="Display disk usage on macOS with du command" /><published>2016-11-26T00:00:00+09:00</published><updated>2016-11-26T00:00:00+09:00</updated><id>http://blog.toshima.ru/2016/11/26/display-disk-usage-command-on-mac</id><content type="html" xml:base="http://blog.toshima.ru/2016/11/26/display-disk-usage-command-on-mac.html">&lt;p&gt;You can get disk usage on MacOS by using &lt;code class=&quot;highlighter-rouge&quot;&gt;du&lt;/code&gt; command.&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$ du -d 1 -h
200M  ./Amazon Music.app
6.1M  ./Android File Transfer.app
1.9M  ./App Store.app
...
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;-d&lt;/code&gt; option means depth. &lt;code class=&quot;highlighter-rouge&quot;&gt;du&lt;/code&gt; outputs result for all files which is too much, so &lt;code class=&quot;highlighter-rouge&quot;&gt;-d 1&lt;/code&gt; option is needed.&lt;/p&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;-h&lt;/code&gt; option means human-readable. This option add unit suffixes such as Byte, Kilobyte, Megabyte, Gigabyte.&lt;/p&gt;

&lt;h2 id=&quot;filter-by-unit&quot;&gt;Filter by unit&lt;/h2&gt;

&lt;p&gt;If you want to filter result by unit:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;du -d 1 -h | grep -e &quot;\dG&quot;
2.0G  ./iMovie.app
1.3G  ./iPhoto.app
8.2G  .
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;</content><author><name>{&quot;twitter&quot;=&gt;&quot;toshimaru_e&quot;}</name></author><category term="mac" /><category term="bash" /><summary type="html">You can get disk usage on MacOS by using du command.</summary></entry><entry><title type="html">Escape ERB tag string in ERB file</title><link href="http://blog.toshima.ru/2016/11/18/escape-erb-tag-in-erb.html" rel="alternate" type="text/html" title="Escape ERB tag string in ERB file" /><published>2016-11-18T00:00:00+09:00</published><updated>2016-11-18T00:00:00+09:00</updated><id>http://blog.toshima.ru/2016/11/18/escape-erb-tag-in-erb</id><content type="html" xml:base="http://blog.toshima.ru/2016/11/18/escape-erb-tag-in-erb.html">&lt;p&gt;How can we output erb tag string like &lt;code class=&quot;highlighter-rouge&quot;&gt;&amp;lt;% erb %&amp;gt;&lt;/code&gt; in erb file without being interpreted as erb? You can do this by using double percent &lt;code class=&quot;highlighter-rouge&quot;&gt;&amp;lt;%% %&amp;gt;&lt;/code&gt;!&lt;/p&gt;

&lt;div class=&quot;language-erb highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;&lt;span class=&quot;cp&quot;&gt;&amp;lt;%%&lt;/span&gt; &lt;span class=&quot;n&quot;&gt;escaped&lt;/span&gt; &lt;span class=&quot;cp&quot;&gt;%&amp;gt;&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Let’s look at how it changes on &lt;code class=&quot;highlighter-rouge&quot;&gt;irb&lt;/code&gt;.&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;$  irb
&amp;gt;  ERB.new(&quot;&amp;lt;%% escaped? %&amp;gt;&quot;).result
=&amp;gt; &quot;&amp;lt;% escaped? %&amp;gt;&quot;
&amp;gt;  ERB.new(&quot;&amp;lt;% escaped? %&amp;gt;&quot;).result
NoMethodError: undefined method `escaped?' for main:Object
	from (erb):1:in `&amp;lt;main&amp;gt;'
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;code class=&quot;highlighter-rouge&quot;&gt;&amp;lt;%%&lt;/code&gt; becomes string without an error.&lt;/p&gt;

&lt;h2 id=&quot;see-also&quot;&gt;See also&lt;/h2&gt;

&lt;ul&gt;
  &lt;li&gt;(JAPANESE) &lt;a href=&quot;http://koseki.hatenablog.com/entry/20090416/erbtag&quot;&gt;http://koseki.hatenablog.com/entry/20090416/erbtag&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;</content><author><name>{&quot;twitter&quot;=&gt;&quot;toshimaru_e&quot;}</name></author><category term="erb" /><category term="ruby" /><summary type="html">How can we output erb tag string like &amp;lt;% erb %&amp;gt; in erb file without being interpreted as erb? You can do this by using double percent &amp;lt;%% %&amp;gt;!</summary></entry></feed>